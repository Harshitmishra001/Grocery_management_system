<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grocery Tracking - SmartNest</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Navigation -->
    <nav class="bg-red-500 text-white p-4 text-center font-bold text-2xl">
        SmartNest - Grocery Tracking
    </nav>

    <!-- Upload Section -->
    <div class="container mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg max-w-3xl text-center">
        <h1 class="text-3xl font-bold text-red-500">Upload Your Bill</h1>
        <p class="mt-4 text-gray-600">Upload an image of your bill, and we'll extract the grocery items for you.</p>

        <!-- File Input -->
        <input type="file" id="billImage" accept="image/*" class="mt-4 p-2 border rounded-lg">
        
        <!-- Upload Button -->
        <button onclick="uploadImage()" class="mt-4 px-6 py-2 bg-red-500 text-white rounded-lg shadow-md hover:bg-red-600 transition">
            Upload & Scan
        </button>

        <!-- Display Extracted Grocery List -->
        <h2 class="mt-6 text-xl font-bold text-gray-700">Detected Groceries:</h2>
        <ul id="groceryList" class="mt-4 text-gray-600"></ul>
        <p id="errorMessage" class="text-red-500 mt-2 hidden"></p>

        <!-- Back Button -->
        <a href="index.html" class="inline-block mt-6 px-6 py-3 bg-gray-500 text-white rounded-lg shadow-md hover:bg-gray-600 transition">
            ‚Üê Back to Home
        </a>
    </div>

    <script>
        function uploadImage() {
    const fileInput = document.getElementById("billImage");
    const file = fileInput.files[0];

    if (!file) {
        alert("Please upload an image!");
        return;
    }

    const formData = new FormData();
    formData.append("image", file); // Ensure "image" matches Flask

    fetch("http://127.0.0.1:5000/upload", {
        method: "POST",
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.error) {
            alert(`Error: ${data.error}`);
            return;
        }

        const groceryList = document.getElementById("groceryList");
        groceryList.innerHTML = "";
        data.items.forEach(item => {
            const li = document.createElement("li");
            li.textContent = `${item.name} - ${item.quantity}`;
            groceryList.appendChild(li);
        });
    })
    .catch(error => {
        console.error("Error:", error);
        alert("An error occurred while processing your request.");
    });
}
</script>

</body>
</html>
